
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Deal Architect - Sales Deal Management</title>
    <script src="https://cdn.tailwindcss.com?plugins=typography"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Outfit', 'Inter', 'Pretendard', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        slate: {
                            50: '#F8FAFC',
                            100: '#F1F5F9',
                            200: '#E2E8F0',
                            300: '#CBD5E1',
                            400: '#94A3B8',
                            500: '#64748B',
                            600: '#475569',
                            700: '#334155',
                            800: '#1E293B',
                            900: '#0F172A',
                        },
                        indigo: {
                            50: '#EEF2FF',
                            100: '#E0E7FF',
                            500: '#6366F1',
                            600: '#4F46E5',
                            700: '#4338CA',
                        }
                    },
                    boxShadow: {
                        'soft': '0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.02)',
                        'card': '0 0 0 1px rgba(226, 232, 240, 1), 0 2px 4px rgba(0, 0, 0, 0.04)',
                        'card-hover': '0 0 0 1px rgba(203, 213, 225, 1), 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.04)',
                        'modal': '0 25px 50px -12px rgba(0, 0, 0, 0.5)',
                        'float': '0 20px 25px -5px rgba(0, 0, 0, 0.3), 0 10px 10px -5px rgba(0, 0, 0, 0.2)'
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="stylesheet" href="css/style.css">
<script type="importmap">
{
  "imports": {
    "path": "https://esm.sh/path@^0.12.7",
    "vite": "https://esm.sh/vite@^7.3.0",
    "firebase/": "https://esm.sh/firebase@^12.7.0/",
    "@google/genai": "https://esm.sh/@google/genai@^1.34.0",
    "url": "https://esm.sh/url@^0.11.4"
  }
}
</script>
</head>
<body class="bg-slate-50 text-slate-900 font-sans antialiased selection:bg-indigo-100 selection:text-indigo-800">
    <nav class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-slate-200 h-16 flex items-center justify-between px-6 lg:px-12 transition-all duration-300 no-print">
        <div class="flex items-center gap-3 cursor-pointer group" id="nav-logo">
            <div class="w-9 h-9 bg-slate-900 text-white flex items-center justify-center rounded-lg text-sm font-bold shadow-sm group-hover:bg-indigo-600 transition-colors duration-300">D</div>
            <span class="font-bold text-lg tracking-tight text-slate-900">Deal Architect</span>
        </div>
        <div class="flex items-center gap-4">
            <div id="migration-tools" class="hidden flex items-center gap-2 mr-4">
                <button id="btn-migrate-data" class="text-xs font-bold text-indigo-700 bg-indigo-50 border border-indigo-200 px-3 py-1.5 rounded-lg hover:bg-indigo-100 transition-all flex items-center gap-1.5">
                    <i class="fa-solid fa-cloud-arrow-up"></i> Firestore로 마이그레이션
                </button>
                <button id="btn-clear-local-data" class="text-xs font-bold text-rose-600 bg-rose-50 border border-rose-200 px-3 py-1.5 rounded-lg hover:bg-rose-100 transition-all flex items-center gap-1.5">
                    <i class="fa-solid fa-trash-can"></i> 로컬 데이터 삭제
                </button>
            </div>
            <button id="nav-back-btn" class="hidden text-sm font-bold text-slate-600 bg-white border border-slate-300 shadow-sm hover:bg-slate-50 hover:text-slate-900 flex items-center gap-2 transition-all px-4 py-2 rounded-lg">
                <i class="fa-solid fa-arrow-left text-xs"></i> Deal 목록으로
            </button>
        </div>
    </nav>
    <main id="app" class="max-w-[1120px] mx-auto p-4 md:p-6 pb-20 min-h-[calc(100vh-4rem)]">
        <div class="flex flex-col items-center justify-center h-64 text-center">
            <div class="spinner mb-4"></div>
            <p class="text-slate-500 font-medium">Initializing Deal Architect...</p>
        </div>
    </main>
    <div id="global-loader" class="fixed inset-0 bg-white/90 z-[60] hidden flex flex-col items-center justify-center backdrop-blur-sm transition-opacity duration-300 no-print">
        <div class="spinner mb-5"></div>
        <p class="text-slate-600 font-medium text-sm tracking-wide animate-pulse" id="loader-text">처리 중...</p>
    </div>
    <div id="toast-container" class="fixed bottom-8 right-8 z-[70] flex flex-col gap-3 no-print"></div>
    <div id="global-modals">
        <div id="warning-modal" class="fixed inset-0 z-[150] hidden flex items-center justify-center p-4">
            <div id="warning-modal-backdrop" class="absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity opacity-0"></div>
            <div id="warning-modal-panel" class="relative bg-slate-900 rounded-xl shadow-modal p-6 max-w-sm w-full transform transition-all scale-95 opacity-0 border border-white/10">
                <div class="flex flex-col items-center text-center">
                    <div class="w-12 h-12 rounded-full bg-amber-500/10 text-amber-500 flex items-center justify-center mb-4 border border-amber-500/20">
                        <i class="fa-solid fa-triangle-exclamation text-xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-white mb-2">알림</h3>
                    <p id="warning-modal-message" class="text-slate-400 text-sm mb-6 leading-relaxed"></p>
                    <button id="warning-modal-close" class="w-full bg-white text-slate-900 py-2.5 rounded-lg font-bold hover:bg-slate-100 transition-colors text-sm shadow-sm">확인</button>
                </div>
            </div>
        </div>
        <div id="confirm-modal" class="fixed inset-0 z-[150] hidden flex items-center justify-center p-4">
            <div id="confirm-modal-backdrop" class="absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity opacity-0"></div>
            <div id="confirm-modal-panel" class="relative bg-slate-900 rounded-xl shadow-modal p-6 max-w-sm w-full transform transition-all scale-95 opacity-0 border border-white/10">
                <div class="flex flex-col items-center text-center">
                    <div class="w-12 h-12 rounded-full bg-indigo-500/10 text-indigo-400 flex items-center justify-center mb-4 border border-indigo-500/20">
                        <i class="fa-solid fa-question text-xl"></i>
                    </div>
                    <h3 class="text-lg font-bold text-white mb-2">확인</h3>
                    <p id="confirm-modal-message" class="text-slate-400 text-sm mb-6 leading-relaxed"></p>
                    <div class="flex gap-3 w-full">
                        <button id="confirm-modal-cancel" class="flex-1 bg-slate-800 text-slate-300 py-2.5 rounded-lg font-bold hover:bg-slate-700 transition-colors text-sm border border-white/5">취소</button>
                        <button id="confirm-modal-ok" class="flex-1 bg-indigo-600 text-white py-2.5 rounded-lg font-bold hover:bg-indigo-700 transition-colors text-sm shadow-sm">확인</button>
                    </div>
                </div>
            </div>
        </div>
        <div id="problem-def-modal" class="fixed inset-0 z-[160] hidden flex items-center justify-center p-4">
            <div id="problem-def-backdrop" class="absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity opacity-0"></div>
            <div id="problem-def-panel" class="relative bg-slate-900 rounded-2xl shadow-modal w-full max-w-3xl transform transition-all scale-95 opacity-0 overflow-hidden flex flex-col max-h-[90vh] border border-white/10">
                <div class="px-8 py-5 border-b border-white/5 bg-black/20 flex justify-between items-center shrink-0">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 rounded-lg bg-indigo-500/20 flex items-center justify-center border border-indigo-500/30 text-indigo-400">
                            <i class="fa-solid fa-file-invoice text-sm" id="report-modal-icon"></i>
                        </div>
                        <h3 class="text-lg font-bold text-white tracking-tight" id="report-modal-title">보고서 초안 검토</h3>
                    </div>
                    <div class="flex items-center gap-4">
                        <div class="flex bg-slate-800 p-1 rounded-lg border border-white/5">
                            <button id="btn-problem-def-preview-mode" class="px-3 py-1 rounded-md text-[11px] font-bold text-white bg-indigo-600 transition-all">미리보기</button>
                            <button id="btn-problem-def-edit-mode" class="px-3 py-1 rounded-md text-[11px] font-bold text-slate-400 hover:text-white transition-all">편집</button>
                        </div>
                        <button id="problem-def-cancel" class="text-slate-500 hover:text-white transition-colors">
                            <i class="fa-solid fa-xmark text-lg"></i>
                        </button>
                    </div>
                </div>
                <div class="p-8 overflow-y-auto custom-scrollbar flex-1 bg-slate-900">
                    <p id="problem-def-guide" class="text-slate-400 text-xs mb-8 leading-relaxed bg-indigo-500/5 p-4 rounded-xl border border-indigo-500/10">
                        <i class="fa-solid fa-circle-info mr-2 text-indigo-400"></i> AI가 분석한 내용을 바탕으로 생성된 초안입니다. 고객에게 공유하기 전 내용을 자유롭게 수정하세요.
                    </p>
                    <div id="problem-def-preview" class="prose prose-invert max-w-none bg-white/[0.02] p-10 rounded-2xl border border-white/5 ..."></div>
                    <textarea id="problem-def-editor" class="hidden input-enterprise !bg-slate-800 !border-white/10 !text-white w-full min-h-[500px] resize-none font-mono text-sm leading-relaxed p-8 focus:!border-indigo-500/50 rounded-2xl" placeholder="보고서 내용을 입력하세요..."></textarea>
                </div>
                <div class="px-8 py-5 border-t border-white/5 bg-black/20 flex justify-end gap-3 shrink-0">
                    <button id="btn-save-problem-def-cancel" class="px-5 py-2.5 bg-slate-800 border border-white/5 hover:bg-slate-700 text-slate-300 rounded-xl text-sm font-bold transition-all">취소</button>
                    <button id="btn-save-problem-def-report" class="px-6 py-2.5 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-500 transition-all text-sm shadow-lg flex items-center gap-2">
                        <i class="fa-solid fa-folder-plus"></i> Reports에 저장
                    </button>
                </div>
            </div>
        </div>
        <div id="solution-detail-modal" class="fixed inset-0 z-[120] hidden flex items-center justify-center p-4">
            <div id="detail-modal-backdrop" class="absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity opacity-0"></div>
            <div id="detail-modal-panel" class="relative bg-slate-900 rounded-2xl shadow-float w-full max-w-md overflow-hidden transform transition-all scale-95 opacity-0 border border-white/10">
                <div class="bg-black/40 px-6 py-5 flex justify-between items-start border-b border-white/5">
                    <div>
                        <div class="text-xs font-medium text-slate-500 mb-1 flex items-center gap-2">
                            <span id="detail-manufacturer"></span>
                            <span class="w-1 h-1 rounded-full bg-slate-700"></span>
                            <span class="text-emerald-400 font-bold" id="detail-share"></span>
                        </div>
                        <h3 class="text-xl font-bold text-white tracking-tight" id="detail-name"></h3>
                    </div>
                    <button id="detail-modal-close" class="text-slate-500 hover:text-white transition-colors">
                        <i class="fa-solid fa-xmark text-lg"></i>
                    </button>
                </div>
                <div class="p-6">
                    <div class="mb-6">
                        <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wide mb-3 flex items-center gap-2">
                            <i class="fa-solid fa-triangle-exclamation text-rose-500"></i> Pain Points
                        </h4>
                        <ul id="detail-painpoints" class="space-y-2 bg-black/20 rounded-xl p-4 border border-white/5"></ul>
                    </div>
                    <div>
                        <h4 class="text-xs font-bold text-slate-400 uppercase tracking-wide mb-3 flex items-center gap-2">
                            <i class="fa-regular fa-note-sticky text-slate-500"></i> Note
                        </h4>
                        <p id="detail-note" class="text-sm text-slate-300 leading-relaxed bg-black/20 border border-white/5 p-3 rounded-lg"></p>
                    </div>
                </div>
            </div>
        </div>
        <div id="custom-tooltip" class="fixed hidden z-[999] pointer-events-none bg-slate-900 text-white p-4 rounded-xl shadow-float border border-white/10 text-sm min-w-[180px] backdrop-blur-md"></div>
    </div>
    <script type="module" src="js/app.js"></script>
</body>
</html>
